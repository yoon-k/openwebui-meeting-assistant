<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI Meeting Assistant - Summarize meetings, extract action items, and generate agendas with AI. Supports 7 languages and multiple LLM providers.">
    <meta name="keywords" content="meeting assistant, AI, meeting summary, action items, agenda generator, OpenAI, Ollama, Claude, OpenWebUI">
    <meta name="author" content="yoon-k">
    <meta property="og:title" content="AI Meeting Assistant | OpenWebUI + LLM">
    <meta property="og:description" content="AI-powered meeting assistant with instant summaries and agenda generation">
    <meta property="og:type" content="website">
    <title>AI Meeting Assistant | Interactive Demo</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EüìÖ%3C/text%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --bg-card: #16161f;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --text-muted: #6b6b7b;
            --accent-primary: #8b5cf6;
            --accent-secondary: #a855f7;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --border-color: rgba(255, 255, 255, 0.08);
            --gradient-primary: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            --gradient-glow: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(99, 102, 241, 0.2) 100%);
            --shadow-glow: 0 0 40px rgba(139, 92, 246, 0.3);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .header {
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 24px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon { font-size: 2rem; }

        .logo h1 {
            font-size: 1.25rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .api-connection {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .api-input {
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.85rem;
            width: 200px;
        }

        .api-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .btn {
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-primary:hover {
            box-shadow: var(--shadow-glow);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            border-color: var(--accent-primary);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-muted);
        }

        .status-dot.connected { background: var(--success); }
        .status-dot.simulation { background: var(--warning); }

        .lang-selector {
            display: flex;
            gap: 4px;
        }

        .lang-btn {
            padding: 6px 10px;
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .lang-btn:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }

        .lang-btn.active {
            background: var(--gradient-primary);
            border-color: transparent;
            color: white;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 24px;
            min-height: calc(100vh - 80px);
        }

        .panel {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            padding: 16px 20px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
        }

        .panel-body {
            padding: 20px;
            flex: 1;
            overflow-y: auto;
        }

        .tabs {
            display: flex;
            gap: 4px;
        }

        .tab {
            padding: 8px 16px;
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .tab:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--gradient-primary);
            border-color: transparent;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .form-textarea {
            min-height: 150px;
            resize: vertical;
        }

        .form-select option {
            background: var(--bg-secondary);
        }

        .btn-full {
            width: 100%;
            padding: 14px;
            font-size: 1rem;
        }

        .result-container {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 24px;
            min-height: 400px;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .result-title {
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .result-actions {
            display: flex;
            gap: 8px;
        }

        .result-section {
            margin-bottom: 24px;
        }

        .result-section h4 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--accent-primary);
        }

        .result-section p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .key-points-list, .decisions-list {
            list-style: none;
        }

        .key-points-list li, .decisions-list li {
            padding: 12px 16px;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
            margin-bottom: 8px;
            border-left: 3px solid var(--accent-primary);
            font-size: 0.9rem;
        }

        .action-item {
            padding: 16px;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
            margin-bottom: 12px;
            border-left: 4px solid var(--accent-primary);
        }

        .action-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .action-item-title {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .priority-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-high {
            background: rgba(239, 68, 68, 0.15);
            color: var(--error);
        }

        .priority-medium {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning);
        }

        .priority-low {
            background: rgba(34, 197, 94, 0.15);
            color: var(--success);
        }

        .action-item-meta {
            font-size: 0.8rem;
            color: var(--text-muted);
            display: flex;
            gap: 16px;
        }

        .agenda-item {
            padding: 16px;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
            margin-bottom: 12px;
        }

        .agenda-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .agenda-item-time {
            font-size: 0.8rem;
            color: var(--accent-primary);
            font-weight: 600;
        }

        .agenda-item-title {
            font-weight: 600;
        }

        .agenda-item-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 16px;
        }

        .empty-state h3 {
            font-size: 1.25rem;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            min-height: 300px;
        }

        .chat-message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
        }

        .chat-message.user {
            background: var(--gradient-primary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .chat-message.assistant {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        .chat-input-container {
            display: flex;
            gap: 8px;
            padding: 16px;
            border-top: 1px solid var(--border-color);
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .template-card {
            padding: 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .template-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .template-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .template-card-icon {
            font-size: 1.5rem;
        }

        .template-card-title {
            font-weight: 600;
        }

        .template-card-duration {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 100px;
            right: 24px;
            padding: 16px 24px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .notification.success { border-left: 4px solid var(--success); }
        .notification.error { border-left: 4px solid var(--error); }
        .notification.info { border-left: 4px solid var(--info); }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .history-item {
            padding: 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .history-item:hover {
            border-color: var(--accent-primary);
        }

        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .history-item-title {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .history-item-date {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .history-item-preview {
            font-size: 0.85rem;
            color: var(--text-secondary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
            }

            .api-connection {
                flex-direction: column;
                width: 100%;
            }

            .api-input {
                width: 100%;
            }

            .lang-selector {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">üìÖ</span>
                <h1 id="logoTitle">AI Meeting Assistant</h1>
            </div>
            <div class="header-controls">
                <div class="api-connection">
                    <input type="text" id="apiUrl" class="api-input" placeholder="http://localhost:5000">
                    <button id="connectBtn" class="btn btn-primary" onclick="toggleConnection()">
                        <span id="connectBtnText">Connect</span>
                    </button>
                    <div class="connection-status">
                        <span class="status-dot" id="statusDot"></span>
                        <span id="statusText">Simulation</span>
                    </div>
                </div>
                <div class="lang-selector">
                    <button class="lang-btn active" data-lang="en" onclick="setLanguage('en')">EN</button>
                    <button class="lang-btn" data-lang="ko" onclick="setLanguage('ko')">KO</button>
                    <button class="lang-btn" data-lang="ja" onclick="setLanguage('ja')">JA</button>
                    <button class="lang-btn" data-lang="zh" onclick="setLanguage('zh')">ZH</button>
                    <button class="lang-btn" data-lang="es" onclick="setLanguage('es')">ES</button>
                    <button class="lang-btn" data-lang="fr" onclick="setLanguage('fr')">FR</button>
                    <button class="lang-btn" data-lang="de" onclick="setLanguage('de')">DE</button>
                </div>
            </div>
        </div>
    </header>

    <main class="main-container">
        <div class="panel">
            <div class="panel-header">
                <span class="panel-title" id="inputPanelTitle">INPUT</span>
            </div>
            <div class="panel-body">
                <div class="tabs" style="margin-bottom: 20px;">
                    <button class="tab active" data-tab="summarize" onclick="showInputTab('summarize')" id="tabSummarize">Summarize</button>
                    <button class="tab" data-tab="agenda" onclick="showInputTab('agenda')" id="tabAgenda">Agenda</button>
                    <button class="tab" data-tab="templates" onclick="showInputTab('templates')" id="tabTemplates">Templates</button>
                </div>

                <!-- Summarize Tab -->
                <div id="summarizeTab" class="tab-content active">
                    <div class="form-group">
                        <label class="form-label" id="transcriptLabel">Meeting Transcript</label>
                        <textarea id="transcriptInput" class="form-textarea" placeholder="Paste your meeting transcript here...">John: Let's discuss the Q4 roadmap.
Sarah: I think we should prioritize the mobile app.
John: Good point. Let's aim for launch by end of November.
Sarah: I'll prepare the technical spec by Friday.
John: Great. Mike, can you handle the backend API?
Mike: Sure, I'll have the endpoints ready by next week.
John: Perfect. Let's also review the budget allocation.
Sarah: Marketing needs 30% for the launch campaign.
Mike: Dev team needs new servers, around $5000.
John: Approved. Let's schedule a follow-up next Monday.</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="meetingTypeLabel">Meeting Type</label>
                        <select id="meetingTypeSelect" class="form-select">
                            <option value="general">General Meeting</option>
                            <option value="standup">Daily Standup</option>
                            <option value="sprint_planning">Sprint Planning</option>
                            <option value="retrospective">Retrospective</option>
                            <option value="brainstorm">Brainstorm</option>
                            <option value="one_on_one">1-on-1</option>
                            <option value="project_kickoff">Project Kickoff</option>
                            <option value="client_meeting">Client Meeting</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="participantsLabel">Participants (comma separated)</label>
                        <input type="text" id="participantsInput" class="form-input" placeholder="John, Sarah, Mike">
                    </div>
                    <button class="btn btn-primary btn-full" onclick="summarizeMeeting()" id="summarizeBtn">
                        <span>üìù</span>
                        <span id="summarizeBtnText">Summarize Meeting</span>
                    </button>
                </div>

                <!-- Agenda Tab -->
                <div id="agendaTab" class="tab-content">
                    <div class="form-group">
                        <label class="form-label" id="topicLabel">Meeting Topic</label>
                        <input type="text" id="topicInput" class="form-input" placeholder="Q4 Product Roadmap Review">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="agendaMeetingTypeLabel">Meeting Type</label>
                        <select id="agendaMeetingType" class="form-select">
                            <option value="general">General Meeting</option>
                            <option value="standup">Daily Standup</option>
                            <option value="sprint_planning">Sprint Planning</option>
                            <option value="retrospective">Retrospective</option>
                            <option value="brainstorm">Brainstorm</option>
                            <option value="one_on_one">1-on-1</option>
                            <option value="project_kickoff">Project Kickoff</option>
                            <option value="client_meeting">Client Meeting</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="durationLabel">Duration (minutes)</label>
                        <select id="durationSelect" class="form-select">
                            <option value="15">15 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="45">45 minutes</option>
                            <option value="60" selected>60 minutes</option>
                            <option value="90">90 minutes</option>
                            <option value="120">120 minutes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="agendaParticipantsLabel">Participants</label>
                        <input type="text" id="agendaParticipants" class="form-input" placeholder="John, Sarah, Mike">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="goalsLabel">Goals (one per line)</label>
                        <textarea id="goalsInput" class="form-textarea" style="min-height: 100px;" placeholder="Review Q4 milestones
Assign responsibilities
Set deadlines"></textarea>
                    </div>
                    <button class="btn btn-primary btn-full" onclick="generateAgenda()" id="agendaBtn">
                        <span>üìã</span>
                        <span id="agendaBtnText">Generate Agenda</span>
                    </button>
                </div>

                <!-- Templates Tab -->
                <div id="templatesTab" class="tab-content">
                    <div id="templatesList"></div>
                </div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header">
                <span class="panel-title" id="resultPanelTitle">RESULTS</span>
                <div class="tabs">
                    <button class="tab active" data-tab="result" onclick="showResultTab('result')" id="tabResult">Result</button>
                    <button class="tab" data-tab="chat" onclick="showResultTab('chat')" id="tabChat">Chat</button>
                    <button class="tab" data-tab="history" onclick="showResultTab('history')" id="tabHistory">History</button>
                </div>
            </div>
            <div class="panel-body" style="padding: 0;">
                <!-- Result Tab -->
                <div id="resultTab" class="tab-content active" style="padding: 20px;">
                    <div id="resultContent">
                        <div class="empty-state">
                            <div class="empty-state-icon">üìù</div>
                            <h3 id="emptyTitle">No Results Yet</h3>
                            <p id="emptyDesc">Summarize a meeting or generate an agenda to see results</p>
                        </div>
                    </div>
                </div>

                <!-- Chat Tab -->
                <div id="chatTab" class="tab-content chat-container">
                    <div id="chatMessages" class="chat-messages"></div>
                    <div class="chat-input-container">
                        <input type="text" id="chatInput" class="chat-input" placeholder="Ask about your meeting..." onkeypress="handleChatKeypress(event)">
                        <button class="btn btn-primary" onclick="sendChatMessage()" id="sendBtn">
                            <span id="sendBtnText">Send</span>
                        </button>
                    </div>
                </div>

                <!-- History Tab -->
                <div id="historyTab" class="tab-content" style="padding: 20px;">
                    <div id="historyList">
                        <div class="empty-state">
                            <div class="empty-state-icon">üìú</div>
                            <h3 id="historyEmptyTitle">No History</h3>
                            <p id="historyEmptyDesc">Your analysis history will appear here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // State
        let isConnected = false;
        let apiBaseUrl = '';
        let currentLang = 'en';
        let currentResult = null;
        let chatHistory = [];
        let analysisHistory = [];

        // i18n
        const i18n = {
            en: {
                logoTitle: 'AI Meeting Assistant',
                inputPanelTitle: 'INPUT',
                resultPanelTitle: 'RESULTS',
                tabSummarize: 'Summarize',
                tabAgenda: 'Agenda',
                tabTemplates: 'Templates',
                tabResult: 'Result',
                tabChat: 'Chat',
                tabHistory: 'History',
                transcriptLabel: 'Meeting Transcript',
                meetingTypeLabel: 'Meeting Type',
                participantsLabel: 'Participants (comma separated)',
                summarizeBtnText: 'Summarize Meeting',
                topicLabel: 'Meeting Topic',
                agendaMeetingTypeLabel: 'Meeting Type',
                durationLabel: 'Duration (minutes)',
                agendaParticipantsLabel: 'Participants',
                goalsLabel: 'Goals (one per line)',
                agendaBtnText: 'Generate Agenda',
                emptyTitle: 'No Results Yet',
                emptyDesc: 'Summarize a meeting or generate an agenda to see results',
                historyEmptyTitle: 'No History',
                historyEmptyDesc: 'Your analysis history will appear here',
                sendBtnText: 'Send',
                connectBtnText: 'Connect',
                disconnectBtnText: 'Disconnect',
                statusConnected: 'Connected',
                statusSimulation: 'Simulation',
                copySuccess: 'Copied to clipboard!',
                exportSuccess: 'Exported successfully!',
                connectionSuccess: 'Connected to API',
                connectionFailed: 'Connection failed',
                summaryTitle: 'Summary',
                keyPoints: 'Key Points',
                decisions: 'Decisions',
                actionItems: 'Action Items',
                nextSteps: 'Next Steps',
                agendaTitle: 'Meeting Agenda',
                objectives: 'Objectives',
                agendaItems: 'Agenda Items',
                preparationItems: 'Preparation Items',
                high: 'High',
                medium: 'Medium',
                low: 'Low'
            },
            ko: {
                logoTitle: 'AI ÌöåÏùò ÎèÑÏö∞ÎØ∏',
                inputPanelTitle: 'ÏûÖÎ†•',
                resultPanelTitle: 'Í≤∞Í≥º',
                tabSummarize: 'ÏöîÏïΩ',
                tabAgenda: 'ÏïàÍ±¥',
                tabTemplates: 'ÌÖúÌîåÎ¶ø',
                tabResult: 'Í≤∞Í≥º',
                tabChat: 'Ï±ÑÌåÖ',
                tabHistory: 'Í∏∞Î°ù',
                transcriptLabel: 'ÌöåÏùò ÎÖπÏ∑®Î°ù',
                meetingTypeLabel: 'ÌöåÏùò Ïú†Ìòï',
                participantsLabel: 'Ï∞∏ÏÑùÏûê (ÏâºÌëúÎ°ú Íµ¨Î∂Ñ)',
                summarizeBtnText: 'ÌöåÏùò ÏöîÏïΩ',
                topicLabel: 'ÌöåÏùò Ï£ºÏ†ú',
                agendaMeetingTypeLabel: 'ÌöåÏùò Ïú†Ìòï',
                durationLabel: 'ÏÜåÏöî ÏãúÍ∞Ñ (Î∂Ñ)',
                agendaParticipantsLabel: 'Ï∞∏ÏÑùÏûê',
                goalsLabel: 'Î™©Ìëú (Ï§ÑÎãπ ÌïòÎÇò)',
                agendaBtnText: 'ÏïàÍ±¥ ÏÉùÏÑ±',
                emptyTitle: 'ÏïÑÏßÅ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§',
                emptyDesc: 'ÌöåÏùòÎ•º ÏöîÏïΩÌïòÍ±∞ÎÇò ÏïàÍ±¥ÏùÑ ÏÉùÏÑ±ÌïòÏó¨ Í≤∞Í≥ºÎ•º ÌôïÏù∏ÌïòÏÑ∏Ïöî',
                historyEmptyTitle: 'Í∏∞Î°ù ÏóÜÏùå',
                historyEmptyDesc: 'Î∂ÑÏÑù Í∏∞Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§',
                sendBtnText: 'Ï†ÑÏÜ°',
                connectBtnText: 'Ïó∞Í≤∞',
                disconnectBtnText: 'Ïó∞Í≤∞ Ìï¥Ï†ú',
                statusConnected: 'Ïó∞Í≤∞Îê®',
                statusSimulation: 'ÏãúÎÆ¨Î†àÏù¥ÏÖò',
                copySuccess: 'ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨Îê®!',
                exportSuccess: 'ÎÇ¥Î≥¥ÎÇ¥Í∏∞ ÏôÑÎ£å!',
                connectionSuccess: 'APIÏóê Ïó∞Í≤∞Îê®',
                connectionFailed: 'Ïó∞Í≤∞ Ïã§Ìå®',
                summaryTitle: 'ÏöîÏïΩ',
                keyPoints: 'ÌïµÏã¨ Ìè¨Ïù∏Ìä∏',
                decisions: 'Í≤∞Ï†ï ÏÇ¨Ìï≠',
                actionItems: 'Ïï°ÏÖò ÏïÑÏù¥ÌÖú',
                nextSteps: 'Îã§Ïùå Îã®Í≥Ñ',
                agendaTitle: 'ÌöåÏùò ÏïàÍ±¥',
                objectives: 'Î™©Ìëú',
                agendaItems: 'ÏïàÍ±¥ Ìï≠Î™©',
                preparationItems: 'Ï§ÄÎπÑ ÏÇ¨Ìï≠',
                high: 'ÎÜíÏùå',
                medium: 'Î≥¥ÌÜµ',
                low: 'ÎÇÆÏùå'
            },
            ja: {
                logoTitle: 'AI„Éü„Éº„ÉÜ„Ç£„É≥„Ç∞„Ç¢„Ç∑„Çπ„Çø„É≥„Éà',
                inputPanelTitle: 'ÂÖ•Âäõ',
                resultPanelTitle: 'ÁµêÊûú',
                tabSummarize: 'Ë¶ÅÁ¥Ñ',
                tabAgenda: '„Ç¢„Ç∏„Çß„É≥„ÉÄ',
                tabTemplates: '„ÉÜ„É≥„Éó„É¨„Éº„Éà',
                tabResult: 'ÁµêÊûú',
                tabChat: '„ÉÅ„É£„ÉÉ„Éà',
                tabHistory: 'Â±•Ê≠¥',
                transcriptLabel: '‰ºöË≠∞„Éà„É©„É≥„Çπ„ÇØ„É™„Éó„Éà',
                meetingTypeLabel: '‰ºöË≠∞„Çø„Ç§„Éó',
                participantsLabel: 'ÂèÇÂä†ËÄÖÔºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ',
                summarizeBtnText: '‰ºöË≠∞„ÇíË¶ÅÁ¥Ñ',
                topicLabel: '‰ºöË≠∞„Éà„Éî„ÉÉ„ÇØ',
                agendaMeetingTypeLabel: '‰ºöË≠∞„Çø„Ç§„Éó',
                durationLabel: 'ÊâÄË¶ÅÊôÇÈñìÔºàÂàÜÔºâ',
                agendaParticipantsLabel: 'ÂèÇÂä†ËÄÖ',
                goalsLabel: 'ÁõÆÊ®ôÔºà1Ë°å„Å´1„Å§Ôºâ',
                agendaBtnText: '„Ç¢„Ç∏„Çß„É≥„ÉÄÁîüÊàê',
                emptyTitle: '„Åæ„Å†ÁµêÊûú„Åå„ÅÇ„Çä„Åæ„Åõ„Çì',
                emptyDesc: '‰ºöË≠∞„ÇíË¶ÅÁ¥Ñ„Åô„Çã„Åã„Ç¢„Ç∏„Çß„É≥„ÉÄ„ÇíÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ',
                historyEmptyTitle: 'Â±•Ê≠¥„Å™„Åó',
                historyEmptyDesc: 'ÂàÜÊûêÂ±•Ê≠¥„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô',
                sendBtnText: 'ÈÄÅ‰ø°',
                connectBtnText: 'Êé•Á∂ö',
                disconnectBtnText: 'ÂàáÊñ≠',
                statusConnected: 'Êé•Á∂öÊ∏à„Åø',
                statusSimulation: '„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥',
                copySuccess: '„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº!',
                exportSuccess: '„Ç®„ÇØ„Çπ„Éù„Éº„ÉàÂÆå‰∫Ü!',
                connectionSuccess: 'API„Å´Êé•Á∂ö„Åó„Åæ„Åó„Åü',
                connectionFailed: 'Êé•Á∂ö„Å´Â§±Êïó„Åó„Åæ„Åó„Åü',
                summaryTitle: 'Ë¶ÅÁ¥Ñ',
                keyPoints: '„Ç≠„Éº„Éù„Ç§„É≥„Éà',
                decisions: 'Ê±∫ÂÆö‰∫ãÈ†Ö',
                actionItems: '„Ç¢„ÇØ„Ç∑„Éß„É≥„Ç¢„Ç§„ÉÜ„É†',
                nextSteps: 'Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó',
                agendaTitle: '‰ºöË≠∞„Ç¢„Ç∏„Çß„É≥„ÉÄ',
                objectives: 'ÁõÆÊ®ô',
                agendaItems: '„Ç¢„Ç∏„Çß„É≥„ÉÄÈ†ÖÁõÆ',
                preparationItems: 'Ê∫ñÂÇô‰∫ãÈ†Ö',
                high: 'È´ò',
                medium: '‰∏≠',
                low: '‰Ωé'
            },
            zh: {
                logoTitle: 'AI‰ºöËÆÆÂä©Êâã',
                inputPanelTitle: 'ËæìÂÖ•',
                resultPanelTitle: 'ÁªìÊûú',
                tabSummarize: 'ÊëòË¶Å',
                tabAgenda: 'ËÆÆÁ®ã',
                tabTemplates: 'Ê®°Êùø',
                tabResult: 'ÁªìÊûú',
                tabChat: 'ËÅäÂ§©',
                tabHistory: 'ÂéÜÂè≤',
                transcriptLabel: '‰ºöËÆÆËÆ∞ÂΩï',
                meetingTypeLabel: '‰ºöËÆÆÁ±ªÂûã',
                participantsLabel: 'ÂèÇ‰∏éËÄÖÔºàÈÄóÂè∑ÂàÜÈöîÔºâ',
                summarizeBtnText: 'ÊÄªÁªì‰ºöËÆÆ',
                topicLabel: '‰ºöËÆÆ‰∏ªÈ¢ò',
                agendaMeetingTypeLabel: '‰ºöËÆÆÁ±ªÂûã',
                durationLabel: 'Êó∂ÈïøÔºàÂàÜÈíüÔºâ',
                agendaParticipantsLabel: 'ÂèÇ‰∏éËÄÖ',
                goalsLabel: 'ÁõÆÊ†áÔºàÊØèË°å‰∏Ä‰∏™Ôºâ',
                agendaBtnText: 'ÁîüÊàêËÆÆÁ®ã',
                emptyTitle: 'ÊöÇÊó†ÁªìÊûú',
                emptyDesc: 'ÊÄªÁªì‰ºöËÆÆÊàñÁîüÊàêËÆÆÁ®ã‰ª•Êü•ÁúãÁªìÊûú',
                historyEmptyTitle: 'ÊöÇÊó†ÂéÜÂè≤',
                historyEmptyDesc: 'ÊÇ®ÁöÑÂàÜÊûêÂéÜÂè≤Â∞ÜÊòæÁ§∫Âú®ËøôÈáå',
                sendBtnText: 'ÂèëÈÄÅ',
                connectBtnText: 'ËøûÊé•',
                disconnectBtnText: 'Êñ≠ÂºÄ',
                statusConnected: 'Â∑≤ËøûÊé•',
                statusSimulation: 'Ê®°ÊãüÊ®°Âºè',
                copySuccess: 'Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ',
                exportSuccess: 'ÂØºÂá∫ÊàêÂäüÔºÅ',
                connectionSuccess: 'Â∑≤ËøûÊé•Âà∞API',
                connectionFailed: 'ËøûÊé•Â§±Ë¥•',
                summaryTitle: 'ÊëòË¶Å',
                keyPoints: 'Ë¶ÅÁÇπ',
                decisions: 'ÂÜ≥Á≠ñ',
                actionItems: 'Ë°åÂä®È°π',
                nextSteps: '‰∏ã‰∏ÄÊ≠•',
                agendaTitle: '‰ºöËÆÆËÆÆÁ®ã',
                objectives: 'ÁõÆÊ†á',
                agendaItems: 'ËÆÆÁ®ãÈ°πÁõÆ',
                preparationItems: 'ÂáÜÂ§á‰∫ãÈ°π',
                high: 'È´ò',
                medium: '‰∏≠',
                low: '‰Ωé'
            },
            es: {
                logoTitle: 'Asistente de Reuniones IA',
                inputPanelTitle: 'ENTRADA',
                resultPanelTitle: 'RESULTADOS',
                tabSummarize: 'Resumir',
                tabAgenda: 'Agenda',
                tabTemplates: 'Plantillas',
                tabResult: 'Resultado',
                tabChat: 'Chat',
                tabHistory: 'Historial',
                transcriptLabel: 'Transcripci√≥n de la Reuni√≥n',
                meetingTypeLabel: 'Tipo de Reuni√≥n',
                participantsLabel: 'Participantes (separados por comas)',
                summarizeBtnText: 'Resumir Reuni√≥n',
                topicLabel: 'Tema de la Reuni√≥n',
                agendaMeetingTypeLabel: 'Tipo de Reuni√≥n',
                durationLabel: 'Duraci√≥n (minutos)',
                agendaParticipantsLabel: 'Participantes',
                goalsLabel: 'Objetivos (uno por l√≠nea)',
                agendaBtnText: 'Generar Agenda',
                emptyTitle: 'Sin Resultados A√∫n',
                emptyDesc: 'Resume una reuni√≥n o genera una agenda para ver resultados',
                historyEmptyTitle: 'Sin Historial',
                historyEmptyDesc: 'Tu historial de an√°lisis aparecer√° aqu√≠',
                sendBtnText: 'Enviar',
                connectBtnText: 'Conectar',
                disconnectBtnText: 'Desconectar',
                statusConnected: 'Conectado',
                statusSimulation: 'Simulaci√≥n',
                copySuccess: '¬°Copiado al portapapeles!',
                exportSuccess: '¬°Exportado con √©xito!',
                connectionSuccess: 'Conectado a la API',
                connectionFailed: 'Conexi√≥n fallida',
                summaryTitle: 'Resumen',
                keyPoints: 'Puntos Clave',
                decisions: 'Decisiones',
                actionItems: 'Elementos de Acci√≥n',
                nextSteps: 'Pr√≥ximos Pasos',
                agendaTitle: 'Agenda de la Reuni√≥n',
                objectives: 'Objetivos',
                agendaItems: 'Elementos de la Agenda',
                preparationItems: 'Elementos de Preparaci√≥n',
                high: 'Alta',
                medium: 'Media',
                low: 'Baja'
            },
            fr: {
                logoTitle: 'Assistant de R√©union IA',
                inputPanelTitle: 'ENTR√âE',
                resultPanelTitle: 'R√âSULTATS',
                tabSummarize: 'R√©sumer',
                tabAgenda: 'Agenda',
                tabTemplates: 'Mod√®les',
                tabResult: 'R√©sultat',
                tabChat: 'Chat',
                tabHistory: 'Historique',
                transcriptLabel: 'Transcription de la R√©union',
                meetingTypeLabel: 'Type de R√©union',
                participantsLabel: 'Participants (s√©par√©s par des virgules)',
                summarizeBtnText: 'R√©sumer la R√©union',
                topicLabel: 'Sujet de la R√©union',
                agendaMeetingTypeLabel: 'Type de R√©union',
                durationLabel: 'Dur√©e (minutes)',
                agendaParticipantsLabel: 'Participants',
                goalsLabel: 'Objectifs (un par ligne)',
                agendaBtnText: 'G√©n√©rer l\'Agenda',
                emptyTitle: 'Pas de R√©sultats Encore',
                emptyDesc: 'R√©sumez une r√©union ou g√©n√©rez un agenda pour voir les r√©sultats',
                historyEmptyTitle: 'Pas d\'Historique',
                historyEmptyDesc: 'Votre historique d\'analyse appara√Ætra ici',
                sendBtnText: 'Envoyer',
                connectBtnText: 'Connecter',
                disconnectBtnText: 'D√©connecter',
                statusConnected: 'Connect√©',
                statusSimulation: 'Simulation',
                copySuccess: 'Copi√© dans le presse-papiers !',
                exportSuccess: 'Export√© avec succ√®s !',
                connectionSuccess: 'Connect√© √† l\'API',
                connectionFailed: '√âchec de la connexion',
                summaryTitle: 'R√©sum√©',
                keyPoints: 'Points Cl√©s',
                decisions: 'D√©cisions',
                actionItems: '√âl√©ments d\'Action',
                nextSteps: 'Prochaines √âtapes',
                agendaTitle: 'Agenda de la R√©union',
                objectives: 'Objectifs',
                agendaItems: '√âl√©ments de l\'Agenda',
                preparationItems: '√âl√©ments de Pr√©paration',
                high: 'Haute',
                medium: 'Moyenne',
                low: 'Basse'
            },
            de: {
                logoTitle: 'KI-Meeting-Assistent',
                inputPanelTitle: 'EINGABE',
                resultPanelTitle: 'ERGEBNISSE',
                tabSummarize: 'Zusammenfassen',
                tabAgenda: 'Agenda',
                tabTemplates: 'Vorlagen',
                tabResult: 'Ergebnis',
                tabChat: 'Chat',
                tabHistory: 'Verlauf',
                transcriptLabel: 'Meeting-Transkript',
                meetingTypeLabel: 'Meeting-Typ',
                participantsLabel: 'Teilnehmer (kommagetrennt)',
                summarizeBtnText: 'Meeting Zusammenfassen',
                topicLabel: 'Meeting-Thema',
                agendaMeetingTypeLabel: 'Meeting-Typ',
                durationLabel: 'Dauer (Minuten)',
                agendaParticipantsLabel: 'Teilnehmer',
                goalsLabel: 'Ziele (eins pro Zeile)',
                agendaBtnText: 'Agenda Generieren',
                emptyTitle: 'Noch keine Ergebnisse',
                emptyDesc: 'Fassen Sie ein Meeting zusammen oder generieren Sie eine Agenda',
                historyEmptyTitle: 'Kein Verlauf',
                historyEmptyDesc: 'Ihr Analyseverlauf erscheint hier',
                sendBtnText: 'Senden',
                connectBtnText: 'Verbinden',
                disconnectBtnText: 'Trennen',
                statusConnected: 'Verbunden',
                statusSimulation: 'Simulation',
                copySuccess: 'In die Zwischenablage kopiert!',
                exportSuccess: 'Erfolgreich exportiert!',
                connectionSuccess: 'Mit API verbunden',
                connectionFailed: 'Verbindung fehlgeschlagen',
                summaryTitle: 'Zusammenfassung',
                keyPoints: 'Kernpunkte',
                decisions: 'Entscheidungen',
                actionItems: 'Aktionspunkte',
                nextSteps: 'N√§chste Schritte',
                agendaTitle: 'Meeting-Agenda',
                objectives: 'Ziele',
                agendaItems: 'Agenda-Punkte',
                preparationItems: 'Vorbereitungspunkte',
                high: 'Hoch',
                medium: 'Mittel',
                low: 'Niedrig'
            }
        };

        // Templates
        const templates = [
            { id: 'standup', icon: 'üåÖ', name: 'Daily Standup', duration: 15 },
            { id: 'sprint_planning', icon: 'üìã', name: 'Sprint Planning', duration: 60 },
            { id: 'retrospective', icon: 'üîÑ', name: 'Retrospective', duration: 60 },
            { id: 'brainstorm', icon: 'üí°', name: 'Brainstorm', duration: 45 },
            { id: 'one_on_one', icon: 'üë•', name: '1-on-1', duration: 30 },
            { id: 'project_kickoff', icon: 'üöÄ', name: 'Project Kickoff', duration: 90 },
            { id: 'client_meeting', icon: 'ü§ù', name: 'Client Meeting', duration: 60 },
            { id: 'code_review', icon: 'üëÄ', name: 'Code Review', duration: 45 }
        ];

        // Simulation responses
        const simulationResponses = {
            summarize: {
                title: 'Q4 Roadmap Discussion',
                summary: 'The team discussed the Q4 roadmap with focus on mobile app development. Key decisions include prioritizing mobile app launch by end of November, with technical specifications and backend API development as immediate priorities.',
                key_points: [
                    'Mobile app prioritized for Q4 development',
                    'Target launch date: End of November',
                    'Technical spec and backend API in parallel development',
                    'Marketing budget: 30% for launch campaign',
                    'Infrastructure investment: $5000 for new servers'
                ],
                decisions: [
                    'Mobile app is the primary Q4 priority',
                    'November deadline for initial launch',
                    'Budget allocations approved for marketing and infrastructure'
                ],
                action_items: [
                    { task: 'Prepare technical specification', assignee: 'Sarah', due_date: 'Friday', priority: 'high' },
                    { task: 'Complete backend API endpoints', assignee: 'Mike', due_date: 'Next week', priority: 'high' },
                    { task: 'Plan marketing launch campaign', assignee: 'Marketing Team', due_date: 'TBD', priority: 'medium' },
                    { task: 'Procure new servers', assignee: 'DevOps', due_date: 'This month', priority: 'medium' }
                ],
                next_steps: [
                    'Schedule follow-up meeting for Monday',
                    'Review technical spec once completed',
                    'Begin sprint planning for mobile development'
                ]
            },
            agenda: {
                title: 'Q4 Product Roadmap Review',
                objectives: [
                    'Review current progress on Q4 initiatives',
                    'Align team on priorities and milestones',
                    'Identify blockers and mitigation strategies'
                ],
                agenda_items: [
                    { time: '0:00 - 0:05', title: 'Welcome & Introduction', description: 'Brief overview of meeting goals' },
                    { time: '0:05 - 0:20', title: 'Progress Review', description: 'Status update on current initiatives' },
                    { time: '0:20 - 0:35', title: 'Priority Discussion', description: 'Review and adjust Q4 priorities' },
                    { time: '0:35 - 0:50', title: 'Blocker Resolution', description: 'Identify and address key blockers' },
                    { time: '0:50 - 0:60', title: 'Action Items & Wrap-up', description: 'Summarize decisions and next steps' }
                ],
                preparation_items: [
                    'Review Q4 roadmap document',
                    'Prepare status updates for your areas',
                    'List any blockers or concerns'
                ]
            },
            chat: [
                "Based on the meeting summary, the main priority is launching the mobile app by the end of November.",
                "Sarah is responsible for the technical specification, due this Friday. Mike will handle the backend API endpoints by next week.",
                "The approved budget includes 30% for marketing and $5000 for new servers.",
                "The next follow-up meeting is scheduled for Monday to review progress.",
                "I can help you with any questions about the meeting. What would you like to know?"
            ]
        };

        // Functions
        function setLanguage(lang) {
            currentLang = lang;
            const texts = i18n[lang];

            Object.keys(texts).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = texts[key];
                }
            });

            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });

            localStorage.setItem('meeting-lang', lang);
            renderTemplates();

            if (currentResult) {
                renderResult(currentResult);
            }
        }

        function getText(key) {
            return i18n[currentLang][key] || i18n['en'][key] || key;
        }

        async function toggleConnection() {
            const url = document.getElementById('apiUrl').value.trim();

            if (isConnected) {
                isConnected = false;
                apiBaseUrl = '';
                localStorage.removeItem('meeting-api');
                updateConnectionStatus();
                return;
            }

            if (!url) {
                showNotification('Please enter API URL', 'error');
                return;
            }

            try {
                const response = await fetch(`${url}/api/health`);
                if (response.ok) {
                    isConnected = true;
                    apiBaseUrl = url;
                    localStorage.setItem('meeting-api', url);
                    showNotification(getText('connectionSuccess'), 'success');
                } else {
                    throw new Error('Health check failed');
                }
            } catch (error) {
                isConnected = false;
                showNotification(getText('connectionFailed'), 'error');
            }

            updateConnectionStatus();
        }

        function updateConnectionStatus() {
            const dot = document.getElementById('statusDot');
            const text = document.getElementById('statusText');
            const btn = document.getElementById('connectBtn');
            const btnText = document.getElementById('connectBtnText');

            if (isConnected) {
                dot.className = 'status-dot connected';
                text.textContent = getText('statusConnected');
                btn.className = 'btn btn-danger';
                btnText.textContent = getText('disconnectBtnText');
            } else {
                dot.className = 'status-dot simulation';
                text.textContent = getText('statusSimulation');
                btn.className = 'btn btn-primary';
                btnText.textContent = getText('connectBtnText');
            }
        }

        function showInputTab(tabName) {
            document.querySelectorAll('.panel:first-child .tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.panel:first-child .tab').forEach(t => t.classList.remove('active'));

            document.getElementById(tabName + 'Tab').classList.add('active');
            document.querySelector(`.panel:first-child .tab[data-tab="${tabName}"]`).classList.add('active');
        }

        function showResultTab(tabName) {
            document.querySelectorAll('.panel:last-child .tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.panel:last-child .tab').forEach(t => t.classList.remove('active'));

            document.getElementById(tabName + 'Tab').classList.add('active');
            document.querySelector(`.panel:last-child .tab[data-tab="${tabName}"]`).classList.add('active');
        }

        function renderTemplates() {
            const container = document.getElementById('templatesList');
            container.innerHTML = templates.map(t => `
                <div class="template-card" onclick="useTemplate('${t.id}', ${t.duration})">
                    <div class="template-card-header">
                        <span class="template-card-icon">${t.icon}</span>
                        <div>
                            <div class="template-card-title">${t.name}</div>
                            <div class="template-card-duration">${t.duration} min</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function useTemplate(type, duration) {
            document.getElementById('agendaMeetingType').value = type;
            document.getElementById('durationSelect').value = duration;
            showInputTab('agenda');
        }

        async function summarizeMeeting() {
            const transcript = document.getElementById('transcriptInput').value.trim();
            const meetingType = document.getElementById('meetingTypeSelect').value;
            const participants = document.getElementById('participantsInput').value.split(',').map(p => p.trim()).filter(p => p);

            if (!transcript) {
                showNotification('Please enter meeting transcript', 'error');
                return;
            }

            showLoading();

            try {
                let result;
                if (isConnected) {
                    const response = await fetch(`${apiBaseUrl}/api/summarize`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            transcript,
                            meeting_type: meetingType,
                            participants
                        })
                    });
                    result = await response.json();
                } else {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    result = simulationResponses.summarize;
                }

                currentResult = { type: 'summary', data: result };
                renderResult(currentResult);
                addToHistory('summary', result.title || 'Meeting Summary', transcript.substring(0, 100));
                showResultTab('result');
            } catch (error) {
                showNotification('Error summarizing meeting: ' + error.message, 'error');
            }
        }

        async function generateAgenda() {
            const topic = document.getElementById('topicInput').value.trim();
            const meetingType = document.getElementById('agendaMeetingType').value;
            const duration = parseInt(document.getElementById('durationSelect').value);
            const participants = document.getElementById('agendaParticipants').value.split(',').map(p => p.trim()).filter(p => p);
            const goals = document.getElementById('goalsInput').value.split('\n').map(g => g.trim()).filter(g => g);

            if (!topic) {
                showNotification('Please enter meeting topic', 'error');
                return;
            }

            showLoading();

            try {
                let result;
                if (isConnected) {
                    const response = await fetch(`${apiBaseUrl}/api/agenda`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            topic,
                            meeting_type: meetingType,
                            duration,
                            participants,
                            goals
                        })
                    });
                    result = await response.json();
                } else {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    result = { ...simulationResponses.agenda, title: topic };
                }

                currentResult = { type: 'agenda', data: result };
                renderResult(currentResult);
                addToHistory('agenda', result.title || topic, `${duration} min meeting`);
                showResultTab('result');
            } catch (error) {
                showNotification('Error generating agenda: ' + error.message, 'error');
            }
        }

        function showLoading() {
            document.getElementById('resultContent').innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            `;
        }

        function renderResult(result) {
            const container = document.getElementById('resultContent');

            if (result.type === 'summary') {
                const data = result.data;
                container.innerHTML = `
                    <div class="result-container">
                        <div class="result-header">
                            <div class="result-title">
                                <span>üìù</span>
                                ${data.title || getText('summaryTitle')}
                            </div>
                            <div class="result-actions">
                                <button class="btn btn-secondary" onclick="copyResult()">üìã Copy</button>
                                <button class="btn btn-secondary" onclick="exportMarkdown()">üìÑ Export</button>
                            </div>
                        </div>

                        ${data.summary ? `
                        <div class="result-section">
                            <h4>üìÑ ${getText('summaryTitle')}</h4>
                            <p>${data.summary}</p>
                        </div>
                        ` : ''}

                        ${data.key_points && data.key_points.length ? `
                        <div class="result-section">
                            <h4>üí° ${getText('keyPoints')}</h4>
                            <ul class="key-points-list">
                                ${data.key_points.map(p => `<li>${p}</li>`).join('')}
                            </ul>
                        </div>
                        ` : ''}

                        ${data.decisions && data.decisions.length ? `
                        <div class="result-section">
                            <h4>‚úÖ ${getText('decisions')}</h4>
                            <ul class="decisions-list">
                                ${data.decisions.map(d => `<li>${d}</li>`).join('')}
                            </ul>
                        </div>
                        ` : ''}

                        ${data.action_items && data.action_items.length ? `
                        <div class="result-section">
                            <h4>üìã ${getText('actionItems')}</h4>
                            ${data.action_items.map(item => `
                                <div class="action-item">
                                    <div class="action-item-header">
                                        <span class="action-item-title">${item.task}</span>
                                        <span class="priority-badge priority-${item.priority}">${getText(item.priority)}</span>
                                    </div>
                                    <div class="action-item-meta">
                                        <span>üë§ ${item.assignee}</span>
                                        <span>üìÖ ${item.due_date}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        ` : ''}

                        ${data.next_steps && data.next_steps.length ? `
                        <div class="result-section">
                            <h4>‚û°Ô∏è ${getText('nextSteps')}</h4>
                            <ul class="key-points-list">
                                ${data.next_steps.map(s => `<li>${s}</li>`).join('')}
                            </ul>
                        </div>
                        ` : ''}
                    </div>
                `;
            } else if (result.type === 'agenda') {
                const data = result.data;
                container.innerHTML = `
                    <div class="result-container">
                        <div class="result-header">
                            <div class="result-title">
                                <span>üìã</span>
                                ${data.title || getText('agendaTitle')}
                            </div>
                            <div class="result-actions">
                                <button class="btn btn-secondary" onclick="copyResult()">üìã Copy</button>
                                <button class="btn btn-secondary" onclick="exportMarkdown()">üìÑ Export</button>
                            </div>
                        </div>

                        ${data.objectives && data.objectives.length ? `
                        <div class="result-section">
                            <h4>üéØ ${getText('objectives')}</h4>
                            <ul class="key-points-list">
                                ${data.objectives.map(o => `<li>${o}</li>`).join('')}
                            </ul>
                        </div>
                        ` : ''}

                        ${data.agenda_items && data.agenda_items.length ? `
                        <div class="result-section">
                            <h4>üìã ${getText('agendaItems')}</h4>
                            ${data.agenda_items.map(item => `
                                <div class="agenda-item">
                                    <div class="agenda-item-header">
                                        <span class="agenda-item-title">${item.title}</span>
                                        <span class="agenda-item-time">${item.time}</span>
                                    </div>
                                    <p class="agenda-item-desc">${item.description}</p>
                                </div>
                            `).join('')}
                        </div>
                        ` : ''}

                        ${data.preparation_items && data.preparation_items.length ? `
                        <div class="result-section">
                            <h4>üìù ${getText('preparationItems')}</h4>
                            <ul class="key-points-list">
                                ${data.preparation_items.map(p => `<li>${p}</li>`).join('')}
                            </ul>
                        </div>
                        ` : ''}
                    </div>
                `;
            }
        }

        function copyResult() {
            if (!currentResult) return;

            let text = '';
            const data = currentResult.data;

            if (currentResult.type === 'summary') {
                text = `# ${data.title || 'Meeting Summary'}\n\n`;
                if (data.summary) text += `## Summary\n${data.summary}\n\n`;
                if (data.key_points) text += `## Key Points\n${data.key_points.map(p => `- ${p}`).join('\n')}\n\n`;
                if (data.decisions) text += `## Decisions\n${data.decisions.map(d => `- ${d}`).join('\n')}\n\n`;
                if (data.action_items) {
                    text += `## Action Items\n`;
                    data.action_items.forEach(item => {
                        text += `- [ ] ${item.task} (@${item.assignee}, Due: ${item.due_date})\n`;
                    });
                }
            } else if (currentResult.type === 'agenda') {
                text = `# ${data.title || 'Meeting Agenda'}\n\n`;
                if (data.objectives) text += `## Objectives\n${data.objectives.map(o => `- ${o}`).join('\n')}\n\n`;
                if (data.agenda_items) {
                    text += `## Agenda\n`;
                    data.agenda_items.forEach(item => {
                        text += `### ${item.time} - ${item.title}\n${item.description}\n\n`;
                    });
                }
            }

            navigator.clipboard.writeText(text);
            showNotification(getText('copySuccess'), 'success');
        }

        function exportMarkdown() {
            if (!currentResult) return;

            let text = '';
            const data = currentResult.data;
            const filename = (data.title || 'meeting').replace(/\s+/g, '_').toLowerCase();

            if (currentResult.type === 'summary') {
                text = `# ${data.title || 'Meeting Summary'}\n\n`;
                if (data.summary) text += `## Summary\n${data.summary}\n\n`;
                if (data.key_points) text += `## Key Points\n${data.key_points.map(p => `- ${p}`).join('\n')}\n\n`;
                if (data.decisions) text += `## Decisions\n${data.decisions.map(d => `- ${d}`).join('\n')}\n\n`;
                if (data.action_items) {
                    text += `## Action Items\n`;
                    data.action_items.forEach(item => {
                        text += `- [ ] **${item.task}**\n  - Assignee: ${item.assignee}\n  - Due: ${item.due_date}\n  - Priority: ${item.priority}\n\n`;
                    });
                }
                if (data.next_steps) text += `## Next Steps\n${data.next_steps.map(s => `- ${s}`).join('\n')}\n`;
            } else if (currentResult.type === 'agenda') {
                text = `# ${data.title || 'Meeting Agenda'}\n\n`;
                if (data.objectives) text += `## Objectives\n${data.objectives.map(o => `- ${o}`).join('\n')}\n\n`;
                if (data.agenda_items) {
                    text += `## Agenda\n`;
                    data.agenda_items.forEach(item => {
                        text += `### ${item.time} - ${item.title}\n${item.description}\n\n`;
                    });
                }
                if (data.preparation_items) text += `## Preparation\n${data.preparation_items.map(p => `- ${p}`).join('\n')}\n`;
            }

            const blob = new Blob([text], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${filename}.md`;
            a.click();
            URL.revokeObjectURL(url);

            showNotification(getText('exportSuccess'), 'success');
        }

        function handleChatKeypress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();

            if (!message) return;

            input.value = '';
            addChatMessage(message, 'user');

            try {
                let response;
                if (isConnected) {
                    const context = currentResult ? JSON.stringify(currentResult.data) : '';
                    const res = await fetch(`${apiBaseUrl}/api/chat`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            message,
                            context,
                            history: chatHistory.map(m => ({ role: m.role, content: m.content })),
                            language: currentLang
                        })
                    });
                    const data = await res.json();
                    response = data.response;
                } else {
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    const responses = simulationResponses.chat;
                    response = responses[Math.floor(Math.random() * responses.length)];
                }

                addChatMessage(response, 'assistant');
            } catch (error) {
                addChatMessage('Sorry, I encountered an error. Please try again.', 'assistant');
            }
        }

        function addChatMessage(content, role) {
            chatHistory.push({ role, content });

            const container = document.getElementById('chatMessages');
            const messageEl = document.createElement('div');
            messageEl.className = `chat-message ${role}`;
            messageEl.textContent = content;
            container.appendChild(messageEl);
            container.scrollTop = container.scrollHeight;
        }

        function addToHistory(type, title, preview) {
            const item = {
                type,
                title,
                preview,
                timestamp: new Date().toISOString(),
                data: currentResult.data
            };

            analysisHistory.unshift(item);
            if (analysisHistory.length > 20) {
                analysisHistory.pop();
            }

            localStorage.setItem('meeting-history', JSON.stringify(analysisHistory));
            renderHistory();
        }

        function renderHistory() {
            const container = document.getElementById('historyList');

            if (analysisHistory.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìú</div>
                        <h3 id="historyEmptyTitle">${getText('historyEmptyTitle')}</h3>
                        <p id="historyEmptyDesc">${getText('historyEmptyDesc')}</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = analysisHistory.map((item, index) => `
                <div class="history-item" onclick="loadHistoryItem(${index})">
                    <div class="history-item-header">
                        <span class="history-item-title">${item.type === 'summary' ? 'üìù' : 'üìã'} ${item.title}</span>
                        <span class="history-item-date">${new Date(item.timestamp).toLocaleDateString()}</span>
                    </div>
                    <p class="history-item-preview">${item.preview}...</p>
                </div>
            `).join('');
        }

        function loadHistoryItem(index) {
            const item = analysisHistory[index];
            currentResult = { type: item.type, data: item.data };
            renderResult(currentResult);
            showResultTab('result');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved settings
            const savedLang = localStorage.getItem('meeting-lang');
            if (savedLang && i18n[savedLang]) {
                setLanguage(savedLang);
            }

            const savedApi = localStorage.getItem('meeting-api');
            if (savedApi) {
                document.getElementById('apiUrl').value = savedApi;
            }

            const savedHistory = localStorage.getItem('meeting-history');
            if (savedHistory) {
                try {
                    analysisHistory = JSON.parse(savedHistory);
                } catch (e) {}
            }

            renderTemplates();
            renderHistory();
            updateConnectionStatus();
        });
    </script>
</body>
</html>
